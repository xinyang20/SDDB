{% extends 'base.html' %}

{% block title %}我的任务{% endblock %}

{% block body %}
<h1>我的任务</h1>

<table>
    <thead>
        <tr>
            <th>任务 ID</th>
            <th>处方 ID</th>
            <th>任务阶段</th>
            <th>状态</th>
            <th>操作</th>
        </tr>
    </thead>
    <tbody>
        {% for task in tasks %}
        <tr>
            <td>{{ task.task_id }}</td>
            <td>{{ task.prescription_id }}</td>
            <td>
                {% if task.receive_worker_id == session['role_id'] %}
                收方任务
                {% elif task.form_worker_id == session['role_id'] %}
                配方任务
                {% elif task.decoction_worker_id == session['role_id'] %}
                煎药任务
                {% endif %}
            </td>
            <td>
                {% if task.status == '完成' %}
                已完成
                {% else %}
                进行中
                {% endif %}
            </td>
            <td>
                {% if task.status != '完成' %}
                <a href="{{ url_for('update_task_status', task_id=task.task_id) }}">更新状态</a>
                {% else %}
                无操作
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}